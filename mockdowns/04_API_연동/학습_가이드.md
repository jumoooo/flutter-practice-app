# ğŸŒ 4ë‹¨ê³„: API ì—°ë™ ë° ë°ì´í„° ê´€ë¦¬

## ğŸ¯ í•™ìŠµ ëª©í‘œ
- HTTP ìš”ì²­ ë³´ë‚´ê¸°
- JSON ë°ì´í„° íŒŒì‹±í•˜ê¸°
- ë¹„ë™ê¸° ì²˜ë¦¬ ì´í•´í•˜ê¸°
- ì—ëŸ¬ í•¸ë“¤ë§í•˜ê¸°
- ë¡œë”© ìƒíƒœ ê´€ë¦¬í•˜ê¸°

---

## ğŸ“š í•µì‹¬ ê°œë…

### 1. HTTP íŒ¨í‚¤ì§€ ì‚¬ìš©

#### íŒ¨í‚¤ì§€ ì¶”ê°€
```yaml
# pubspec.yaml
dependencies:
  http: ^1.1.0
```

```dart
import 'package:http/http.dart' as http;
```

---

### 2. GET ìš”ì²­

```dart
// ê°„ë‹¨í•œ GET ìš”ì²­
Future<String> fetchData() async {
  final response = await http.get(
    Uri.parse('https://api.example.com/data'),
  );
  
  if (response.statusCode == 200) {
    return response.body;
  } else {
    throw Exception('Failed to load data');
  }
}
```

---

### 3. JSON íŒŒì‹±

#### ëª¨ë¸ í´ë˜ìŠ¤ ë§Œë“¤ê¸°
```dart
// user.dart
class User {
  final int id;
  final String name;
  final String email;
  
  User({
    required this.id,
    required this.name,
    required this.email,
  });
  
  // JSONì—ì„œ ê°ì²´ë¡œ ë³€í™˜
  factory User.fromJson(Map<String, dynamic> json) {
    return User(
      id: json['id'],
      name: json['name'],
      email: json['email'],
    );
  }
  
  // ê°ì²´ì—ì„œ JSONìœ¼ë¡œ ë³€í™˜
  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'name': name,
      'email': email,
    };
  }
}
```

#### JSON íŒŒì‹±í•˜ê¸°
```dart
import 'dart:convert';

Future<User> fetchUser() async {
  final response = await http.get(
    Uri.parse('https://api.example.com/user'),
  );
  
  if (response.statusCode == 200) {
    // JSON ë¬¸ìì—´ì„ Mapìœ¼ë¡œ ë³€í™˜
    Map<String, dynamic> json = jsonDecode(response.body);
    // Mapì„ User ê°ì²´ë¡œ ë³€í™˜
    return User.fromJson(json);
  } else {
    throw Exception('Failed to load user');
  }
}
```

---

### 4. ë¹„ë™ê¸° ì²˜ë¦¬ (async/await)

```dart
// async: ë¹„ë™ê¸° í•¨ìˆ˜ ì„ ì–¸
Future<void> loadData() async {
  // await: ë¹„ë™ê¸° ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°
  final data = await fetchData();
  print(data);
}
```

---

### 5. FutureBuilder ì‚¬ìš©

```dart
FutureBuilder<User>(
  future: fetchUser(),
  builder: (context, snapshot) {
    // ë¡œë”© ì¤‘
    if (snapshot.connectionState == ConnectionState.waiting) {
      return CircularProgressIndicator();
    }
    
    // ì—ëŸ¬ ë°œìƒ
    if (snapshot.hasError) {
      return Text('ì—ëŸ¬: ${snapshot.error}');
    }
    
    // ë°ì´í„° ë¡œë“œ ì™„ë£Œ
    if (snapshot.hasData) {
      return Text('ì´ë¦„: ${snapshot.data!.name}');
    }
    
    return Text('ë°ì´í„° ì—†ìŒ');
  },
)
```

---

### 6. ë¡œë”© ìƒíƒœ ê´€ë¦¬

```dart
class _DataScreenState extends State<DataScreen> {
  bool isLoading = false;
  String? data;
  String? error;
  
  Future<void> loadData() async {
    setState(() {
      isLoading = true;
      error = null;
    });
    
    try {
      final result = await fetchData();
      setState(() {
        data = result;
        isLoading = false;
      });
    } catch (e) {
      setState(() {
        error = e.toString();
        isLoading = false;
      });
    }
  }
  
  @override
  Widget build(BuildContext context) {
    if (isLoading) {
      return CircularProgressIndicator();
    }
    
    if (error != null) {
      return Text('ì—ëŸ¬: $error');
    }
    
    return Text(data ?? 'ë°ì´í„° ì—†ìŒ');
  }
}
```

---

## ğŸ¯ ì‹¤ì „ ì˜ˆì œ

### ì˜ˆì œ 1: ë‰´ìŠ¤ ë¦¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°

```dart
// news.dart
class News {
  final String title;
  final String description;
  final String url;
  
  News({
    required this.title,
    required this.description,
    required this.url,
  });
  
  factory News.fromJson(Map<String, dynamic> json) {
    return News(
      title: json['title'],
      description: json['description'],
      url: json['url'],
    );
  }
}

// api_service.dart
class ApiService {
  static Future<List<News>> fetchNews() async {
    final response = await http.get(
      Uri.parse('https://api.example.com/news'),
    );
    
    if (response.statusCode == 200) {
      List<dynamic> jsonList = jsonDecode(response.body);
      return jsonList.map((json) => News.fromJson(json)).toList();
    } else {
      throw Exception('Failed to load news');
    }
  }
}

// news_list_screen.dart
class NewsListScreen extends StatefulWidget {
  @override
  State<NewsListScreen> createState() => _NewsListScreenState();
}

class _NewsListScreenState extends State<NewsListScreen> {
  List<News> newsList = [];
  bool isLoading = true;
  
  @override
  void initState() {
    super.initState();
    loadNews();
  }
  
  Future<void> loadNews() async {
    try {
      final news = await ApiService.fetchNews();
      setState(() {
        newsList = news;
        isLoading = false;
      });
    } catch (e) {
      setState(() {
        isLoading = false;
      });
      // ì—ëŸ¬ ì²˜ë¦¬
    }
  }
  
  @override
  Widget build(BuildContext context) {
    if (isLoading) {
      return Center(child: CircularProgressIndicator());
    }
    
    return ListView.builder(
      itemCount: newsList.length,
      itemBuilder: (context, index) {
        return ListTile(
          title: Text(newsList[index].title),
          subtitle: Text(newsList[index].description),
        );
      },
    );
  }
}
```

---

### ì˜ˆì œ 2: POST ìš”ì²­

```dart
Future<void> createPost(String title, String content) async {
  final response = await http.post(
    Uri.parse('https://api.example.com/posts'),
    headers: {
      'Content-Type': 'application/json',
    },
    body: jsonEncode({
      'title': title,
      'content': content,
    }),
  );
  
  if (response.statusCode == 201) {
    print('ê²Œì‹œê¸€ ìƒì„± ì„±ê³µ');
  } else {
    throw Exception('Failed to create post');
  }
}
```

---

## ğŸ’¡ ë‹¤ìŒ ë‹¨ê³„

ì´ì œ API ì—°ë™ì„ ë°°ì› ìŠµë‹ˆë‹¤!

**ë‹¤ìŒ ë‹¨ê³„:** `ì‹¤ìŠµ_ë¬¸ì œ.md`ë¥¼ ì—´ì–´ì„œ ì§ì ‘ êµ¬í˜„í•´ë³´ì„¸ìš”!

**ì¶”ê°€ í•™ìŠµ:**
- `05_ìƒíƒœê´€ë¦¬_ì‹¬í™”/` - ì „ì—­ ìƒíƒœ ê´€ë¦¬

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [http íŒ¨í‚¤ì§€](https://pub.dev/packages/http)
- [JSON ì§ë ¬í™”](https://docs.flutter.dev/data-and-backend/json)
- [ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°](https://dart.dev/codelabs/async-await)

**ì¤€ë¹„ë˜ì…¨ë‚˜ìš”? ì‹¤ìŠµ ë¬¸ì œë¡œ ë„˜ì–´ê°€ì„¸ìš”! ğŸš€**
